<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="description" content="D3 homework">
    <title>D3 Homework</title>
    <style>
        #chart rect {
            fill: #6A5ACD; /* Dark lavender color */
        }
        #chart text {
            fill: white;
            font: 10px sans-serif;
            text-anchor: end;
        }
        .axis text {
            font: 10px sans-serif;
        }
        .axis path, .axis line {
            fill: none;
            stroke: #fff;
            shape-rendering: crispEdges;
        }
        body {
            background: #1a1a1a;
            color: #eaeaea;
            padding: 10px;
        }
        .tooltip {
            position: absolute;
            text-align: center;
            padding: 8px;
            font: 12px sans-serif;
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid #ccc;
            border-radius: 4px;
            pointer-events: none;
            opacity: 0;
            /* This is the new rule to make the font visible */
            color: black; 
        }
    </style>
</head>
<body>
    <div id="chart"></div>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script>
        // Data is now embedded directly in the script
        var data = [
            {"term": "Spring 16", "students": 160},
            {"term": "Fall 16", "students": 170},
            {"term": "Spring 17", "students": 120},
            {"term": "Fall 17", "students": 185},
            {"term": "Spring 18", "students": 190},
            {"term": "Fall 18", "students": 195}
        ];

        // Set up SVG dimensions and margins
        var margin = { top: 20, right: 20, bottom: 30, left: 40 },
            width = 600 - margin.left - margin.right,
            height = 400 - margin.top - margin.bottom;

        // Define the x and y scales
        var x = d3.scaleBand()
            .rangeRound([0, width])
            .padding(0.1);

        var y = d3.scaleLinear()
            .rangeRound([height, 0]);

        // Append the SVG to the #chart div
        var svg = d3.select("#chart").append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        // Append the tooltip div to the body for easy positioning
        var tooltip = d3.select("body").append("div")
            .attr("class", "tooltip")
            .style("opacity", 0);

        // Convert students to a number
        data.forEach(function(d) {
            d.students = +d.students;
        });

        // Set the domain for the scales based on the data
        x.domain(data.map(function(d) { return d.term; }));
        y.domain([0, d3.max(data, function(d) { return d.students; })]);

        // Create the bars
        svg.selectAll(".bar")
            .data(data)
            .enter().append("rect")
            .attr("class", "bar")
            .attr("x", function(d) { return x(d.term); })
            .attr("y", function(d) { return y(d.students); })
            .attr("width", x.bandwidth())
            .attr("height", function(d) { return height - y(d.students); })
            .on("mouseover", function(d) {
                tooltip.transition()
                    .duration(200)
                    .style("opacity", .9);
                tooltip.html("Term: " + d.term + "<br/>Students: " + d.students)
                    .style("left", (d3.event.pageX + 10) + "px")
                    .style("top", (d3.event.pageY - 28) + "px");
            })
            .on("mouseout", function(d) {
                tooltip.transition()
                    .duration(500)
                    .style("opacity", 0);
            });

        // Add the x-axis
        svg.append("g")
            .attr("class", "axis axis--x")
            .attr("transform", "translate(0," + height + ")")
            .call(d3.axisBottom(x));

        // Add the y-axis
        svg.append("g")
            .attr("class", "axis axis--y")
            .call(d3.axisLeft(y).ticks(10));
    </script>
</body>
</html>
